# -*- coding: utf-8 -*-
"""Diesel Price.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1XZEJ7Xn4ZKS0SN9oW7gmuIFFCcyFma-6
"""

import pandas as pd
import matplotlib .pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score,mean_squared_error,root_mean_squared_error,mean_absolute_error
import seaborn as sns

df=pd.read_csv('diesel.csv')
df

df.head(5)

df.tail(5)

df.isnull()

df.isnull().sum()

df.shape

df.size

df.empty

df.columns

df.index

df.count()

df.dropna()

df.duplicated()

pd.to_datetime(df['date']).dt.year
df['year']=pd.to_datetime(df['date']).dt.year
df

X=df[['year']]
Y=df[['rate']]

X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.2,random_state=1)

X_train,X_test
Y_train,Y_test

MODEL=LinearRegression()
MODEL.fit(X_train,Y_train)
Pred=MODEL.predict(X_test)

coefficients=MODEL.coef_
intercept=MODEL.intercept_
print(coefficients)
print(intercept)

mse=mean_squared_error(Y_test,Pred)
rmse=root_mean_squared_error(Y_test,Pred)
mae=mean_absolute_error(Y_test,Pred)
r2=r2_score(Y_test,Pred)

print('MSE:',mse)
print('RMSE:',rmse)
print('MAE:',mae)
print('R2:',r2)

df.plot(kind='scatter',x='year',y='rate')
plt.plot(X_test,Pred,color='red')
plt.show()

plt.figure(figsize=(10, 6))  # Adjust figure size if needed
sns.scatterplot(x='year', y='rate', data=df, label='Actual Data')
plt.plot(X_test, Pred, color='red', label='Regression Line')
plt.xlabel('Year')
plt.ylabel('Rate')
plt.title('Diesel Rate Prediction')
plt.legend()
plt.grid(True)
plt.show()

plt.figure(figsize=(12, 6))
sns.regplot(x='year', y='rate', data=df, color='blue', line_kws={'color': 'red'})
plt.xlabel('Year')
plt.ylabel('Diesel Rate')
plt.title('Diesel Rate Trend over Time')
plt.grid(True)
plt.show()

